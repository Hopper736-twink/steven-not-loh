<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Steven: Legend of Gold</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
  body { margin:0; background:#111; color:white; font-family:Arial; text-align:center; }
  canvas { background:#222; display:block; margin:0 auto; }
</style>
</head>
<body>

<h2>Steven: Legend of Gold</h2>
<p>WASD / Стрелки — движение | Space — прыжок | Shift — рывок</p>

<canvas id="game" width="360" height="540"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let keys = {};
document.addEventListener("keydown", e => keys[e.key] = true);
document.addEventListener("keyup", e => keys[e.key] = false);

const GRAVITY = 1.2;

let player = {
  x: 50, y: 420, w: 30, h: 30,
  vx: 0, vy: 0,
  hp: 60,
  onGround: false,
  lastDash: 0
};

let enemies = [
  { x: 300, y: 430, w: 30, h: 30, hp: 20 },
  { x: 500, y: 430, w: 30, h: 30, hp: 20 }
];

let boss = {
  x: 900, y: 400, w: 60, h: 60, hp: 100
};

let cameraX = 0;
let gameWon = false;

function rect(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x &&
         a.y < b.y+b.h && a.y+a.h > b.y;
}

function update(){
  if(gameWon) return;

  // движение
  if(keys["a"] || keys["ArrowLeft"]) player.vx = -4;
  if(keys["d"] || keys["ArrowRight"]) player.vx = 4;
  if((keys[" "] || keys["Space"]) && player.onGround){
    player.vy = -15;
    player.onGround = false;
  }

  // рывок
  if(keys["Shift"] && Date.now() - player.lastDash > 1000){
    player.vx *= 4;
    player.lastDash = Date.now();
  }

  player.vy += GRAVITY;
  player.x += player.vx;
  player.y += player.vy;
  player.vx *= 0.8;

  // земля
  if(player.y + player.h >= 480){
    player.y = 480 - player.h;
    player.vy = 0;
    player.onGround = true;
  }

  // камера
  cameraX = player.x - 100;

  // враги
  enemies.forEach(e => {
    e.x -= 1;
    if(rect(player,e)){
      e.hp -= 1;
      player.hp -= 0.2;
    }
  });

  enemies = enemies.filter(e => e.hp > 0);

  // босс
  if(rect(player,boss)){
    boss.hp -= 0.5;
    player.hp -= 0.5;
  }

  if(boss.hp <= 0){
    gameWon = true;
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  ctx.save();
  ctx.translate(-cameraX,0);

  // земля
  ctx.fillStyle="#444";
  ctx.fillRect(-1000,480,3000,60);

  // игрок
  ctx.fillStyle="gold";
  ctx.fillRect(player.x,player.y,player.w,player.h);

  // враги
  ctx.fillStyle="red";
  enemies.forEach(e => ctx.fillRect(e.x,e.y,e.w,e.h));

  // босс
  ctx.fillStyle="purple";
  ctx.fillRect(boss.x,boss.y,boss.w,boss.h);

  ctx.restore();

  // HUD
  ctx.fillStyle="white";
  ctx.fillText("HP: "+Math.floor(player.hp),10,20);

  if(gameWon){
    ctx.fillStyle="rgba(0,0,0,0.8)";
    ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="gold";
    ctx.font="20px Arial";
    ctx.fillText("Стивен стал легендой",60,220);
    ctx.font="16px Arial";
    ctx.fillText("Тут был Hopper736",90,260);
  }
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}

loop();
</script>

</body>
</html>
